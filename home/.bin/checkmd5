#!/usr/bin/perl
#Quick script to check whether a file matches a given MD5 sum;
#Usage: checkmd5 <md5sum> file
#example: checkmd5 aa1906a7b197eb47b91b9095d2c60bde file.zip

use strict;
use warnings;
use feature 'say'; #say is so much better than print;

my ($target_checksum, $file) = @ARGV #unpack arguments;
   or die 'usage: checkmd5 $md5sum $file'; # die on failure

my $check_output = `md5sum "$file"`; #get the real MD5 sum, for comparison;
chomp $check_output; #remove pesky trialing newline;
my @check_output = split('\s', $check_output); #break up md5sum output on whitespace;

my $real_checksum = shift @check_output; #get the real MD5 sum, for comparison;
$real_checksum eq lc $target_checksum #if real checksum matches the target we want;
    ? say "Success! File matches the specified MD5sum." #report the good news;
    : say "FAILURE: file '$file' does not match checksum '$target_checksum'
        The checksum found was: '$real_checksum'"; #report the bad news;
